<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible"><meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1,user-scalable=no"><meta name="renderer" content="webkit"><meta name="color-scheme" content="dark light"><meta name="author" content="Hello_RS"><meta name="description" content=""><meta name="keywords" content=""><title>Hexo</title><link rel="icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="//at.alicdn.com/t/font_3242539_utq6ykfq7z.css"><link rel="stylesheet" light-src="https://cdn.staticfile.org/highlight.js/11.5.0/styles/default.min.css" dark-src="https://cdn.staticfile.org/highlight.js/11.5.0/styles/tokyo-night-dark.min.css"><link rel="stylesheet" href="https://fonts.font.im/css?family=Noto+Serif" as="font"><link href="/style/index.css" rel="stylesheet"><meta name="generator" content="Hexo 5.4.2"></head><body><header class="page-header"><nav><ul class="router-list"><li class="nav-item"> <a href="/">主页</a></li><li class="nav-item"> <a href="/archives/">归档</a></li><li class="nav-item"> <a href="/atom.xml">RSS</a></li></ul><div class="mode-switch"><span class="iconfont icon-DarkTheme"></span></div></nav></header><main><section class="main-content"><section class="post-page"><div class="title-bar"><h1></h1><div class="post-info"><span>2023-01-04 21:49:06</span><span class="tags"></span></div></div><article> <div class="content"><h3 id="DOS头解析"><a href="#DOS头解析" class="headerlink" title="DOS头解析"></a>DOS头解析</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">DOS头</span><br><span class="line"><span class="number">0x00</span> WORD e_magic;  </span><br><span class="line"><span class="number">0x02</span> WORD e_cblp;   </span><br><span class="line"><span class="number">0x04</span> WORD e_cp;</span><br><span class="line"><span class="number">0x06</span> WORD e_crlc;</span><br><span class="line"><span class="number">0x08</span> WORD e_cparhdr;</span><br><span class="line"><span class="number">0X0a</span> WORD e_minalloc;</span><br><span class="line"><span class="number">0x0c</span> WORD e_maxalloc;</span><br><span class="line"><span class="number">0x0e</span> WORD e_ss;</span><br><span class="line"><span class="number">0x10</span> WORD e_sp;</span><br><span class="line"><span class="number">0x12</span> WORD e_csum;</span><br><span class="line"><span class="number">0x14</span> WORD e_ip;</span><br><span class="line"><span class="number">0x16</span> WORD e_cs;</span><br><span class="line"><span class="number">0x18</span> WORD e_lfarlc;</span><br><span class="line"><span class="number">0x1a</span> WORD e_ovno;</span><br><span class="line"><span class="number">0x1c</span> WORD e_res[<span class="number">4</span>];</span><br><span class="line"><span class="number">0x24</span> WORD e_oemid;</span><br><span class="line"><span class="number">0x26</span> WORD e_oeminfo;</span><br><span class="line"><span class="number">0x28</span> WORD e_res2[<span class="number">10</span>]</span><br><span class="line"><span class="number">0x3c</span> DWORD e_lfanew;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">DOS头</span><br><span class="line"><span class="number">0x00</span> WORD e_magic;  <span class="number">5</span>a4d</span><br><span class="line"><span class="number">0x02</span> WORD e_cblp;   <span class="number">0090</span></span><br><span class="line"><span class="number">0x04</span> WORD e_cp;     <span class="number">0003</span></span><br><span class="line"><span class="number">0x06</span> WORD e_crlc;   <span class="number">0000</span></span><br><span class="line"><span class="number">0x08</span> WORD e_cparhdr;  <span class="number">0004</span></span><br><span class="line"><span class="number">0X0a</span> WORD e_minalloc; <span class="number">0000</span></span><br><span class="line"><span class="number">0x0c</span> WORD e_maxalloc; FFFF</span><br><span class="line"><span class="number">0x0e</span> WORD e_ss;       <span class="number">0000</span></span><br><span class="line"><span class="number">0x10</span> WORD e_sp;       <span class="number">00B</span>8</span><br><span class="line"><span class="number">0x12</span> WORD e_csum;     <span class="number">0000</span></span><br><span class="line"><span class="number">0x14</span> WORD e_ip;       <span class="number">0000</span></span><br><span class="line"><span class="number">0x16</span> WORD e_cs;       <span class="number">0000</span></span><br><span class="line"><span class="number">0x18</span> WORD e_lfarlc;   <span class="number">0040</span></span><br><span class="line"><span class="number">0x1a</span> WORD e_ovno;     <span class="number">0000</span></span><br><span class="line"><span class="number">0x1c</span> WORD e_res[<span class="number">4</span>];   <span class="number">0000</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">0000</span></span><br><span class="line"><span class="number">0x24</span> WORD e_oemid;    <span class="number">0000</span></span><br><span class="line"><span class="number">0x26</span> WORD e_oeminfo;  <span class="number">0000</span></span><br><span class="line"><span class="number">0x28</span> WORD e_res2[<span class="number">10</span>]  <span class="number">00</span> *<span class="number">20</span></span><br><span class="line"><span class="number">0x3c</span> DWORD e_lfanew;  <span class="number">0000</span> <span class="number">00</span>D0</span><br></pre></td></tr></table></figure>





<h3 id="PE头解析"><a href="#PE头解析" class="headerlink" title="PE头解析"></a>PE头解析</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0x00 DWORD  Signature</span><br><span class="line">0x04 _IMAGE_FILE_HEADER FileHeader;</span><br><span class="line">0x18 _IMAGE_OPTIONAL_HEADER OptionalHeader;</span><br></pre></td></tr></table></figure>



<h4 id="1-IMAGE-FILE-HEADER-FileHeader"><a href="#1-IMAGE-FILE-HEADER-FileHeader" class="headerlink" title="1._IMAGE_FILE_HEADER FileHeader"></a>1._IMAGE_FILE_HEADER FileHeader</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x00</span> WORD Machine;</span><br><span class="line"><span class="number">0x02</span> WORD NumberOfSections;</span><br><span class="line"><span class="number">0x04</span> DWORD TimeDateStamp;</span><br><span class="line"><span class="number">0x08</span> DWORD PointerToSymbolTable;</span><br><span class="line"><span class="number">0x0c</span> DWORD NumberOfSymbols</span><br><span class="line"><span class="number">0x10</span> WORD SizeOfOptionalHeader;</span><br><span class="line"><span class="number">0x12</span> WORD Characteristics;</span><br></pre></td></tr></table></figure>



<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x00</span> WORD Machine;   <span class="number">014</span>c </span><br><span class="line"><span class="number">0x02</span> WORD NumberOfSections; <span class="number">0005</span></span><br><span class="line"><span class="number">0x04</span> DWORD TimeDateStamp;  <span class="number">635</span>a7daf</span><br><span class="line"><span class="number">0x08</span> DWORD PointerToSymbolTable; <span class="number">0000</span> <span class="number">0000</span></span><br><span class="line"><span class="number">0x0c</span> DWORD NumberOfSymbols <span class="number">0000</span> <span class="number">0000</span></span><br><span class="line"><span class="number">0x10</span> WORD SizeOfOptionalHeader; <span class="number">00</span>eo</span><br><span class="line"><span class="number">0x12</span> WORD Characteristics; <span class="number">010</span>e</span><br></pre></td></tr></table></figure>



<h4 id="2-IMAGE-OPTIONAL-HEADER-OptionalHeader"><a href="#2-IMAGE-OPTIONAL-HEADER-OptionalHeader" class="headerlink" title="2._IMAGE_OPTIONAL_HEADER OptionalHeader"></a>2._IMAGE_OPTIONAL_HEADER OptionalHeader</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x00</span> WORD Magic;    </span><br><span class="line"><span class="number">0X02</span> BYTE MajorLinkerVersion;</span><br><span class="line"><span class="number">0X03</span> BYTE MinorLinkerVersion;</span><br><span class="line"><span class="number">0x04</span> DWORD SizeOfCode;</span><br><span class="line"><span class="number">0x08</span> DWORD SizeOflnitializedData;</span><br><span class="line"><span class="number">0x0c</span> DWORD SizeOfUninitializedData;</span><br><span class="line"><span class="number">0x10</span> DWORD AddressOfEntryPoint;</span><br><span class="line"><span class="number">0x14</span> DWORD BaseOfCode;</span><br><span class="line"><span class="number">0x18</span> DWORD BaseOfData;</span><br><span class="line"><span class="number">0x1c</span> DWORD ImageBase;</span><br><span class="line"><span class="number">0x20</span> DWORD SectionAlignment;</span><br><span class="line"><span class="number">0x24</span> DWORD FileAlignment;</span><br><span class="line"><span class="number">0x28</span> WORD MajorOperatingSystemVersion;</span><br><span class="line"><span class="number">0x2a</span> WORD MinorOperatingSystemVersion;</span><br><span class="line"><span class="number">0x2c</span> WORD MajorImageVersion;</span><br><span class="line"><span class="number">0x2e</span> WORD MinorImageVersion;</span><br><span class="line"><span class="number">0x30</span> WORD MajorSubsystemVersion;</span><br><span class="line"><span class="number">0x32</span> WORD MinorSubsystemVersion;</span><br><span class="line"><span class="number">0x34</span> DWORD Win32VersionValue;</span><br><span class="line"><span class="number">0x38</span> DWORD SizeOfImage;</span><br><span class="line"><span class="number">0x3c</span> DWORD SizeOfHeaders;</span><br><span class="line"><span class="number">0x40</span> DWORD CheckSum;</span><br><span class="line"><span class="number">0x44</span> WORD Subsystem;</span><br><span class="line"><span class="number">0x46</span> WORD DllCharacteristics;</span><br><span class="line"><span class="number">0x48</span> DWORD SizeOfStackReserve;</span><br><span class="line"><span class="number">0x4c</span> DWORD SizeOfStackCommit;</span><br><span class="line"><span class="number">0x50</span> DWORD SizeOfHeapReserve;</span><br><span class="line"><span class="number">0x54</span> DWORD SizeOfHeapCommit;</span><br><span class="line"><span class="number">0x58</span> DWORD LoderFlags;</span><br><span class="line"><span class="number">0x5c</span> DWORD NumberOfRvaAndSizes;</span><br><span class="line"><span class="number">0x60</span> _IMAGE_DATA_DIRECTORY DataDirectory[<span class="number">16</span>];</span><br></pre></td></tr></table></figure>





<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x00</span> WORD Magic;    <span class="number">010b</span></span><br><span class="line"><span class="number">0X02</span> BYTE MajorLinkerVersion;  <span class="number">06</span></span><br><span class="line"><span class="number">0X03</span> BYTE MinorLinkerVersion;  <span class="number">00</span></span><br><span class="line"><span class="number">0x04</span> DWORD SizeOfCode; <span class="number">00023000</span></span><br><span class="line"><span class="number">0x08</span> DWORD SizeOflnitializedData; <span class="number">0000</span>a000</span><br><span class="line"><span class="number">0x0c</span> DWORD SizeOfUninitializedData;<span class="number">0000</span> <span class="number">0000</span></span><br><span class="line"><span class="number">0x10</span> DWORD AddressOfEntryPoint;<span class="number">0000</span> <span class="number">1340</span></span><br><span class="line"><span class="number">0x14</span> DWORD BaseOfCode; <span class="number">0000</span> <span class="number">1000</span></span><br><span class="line"><span class="number">0x18</span> DWORD BaseOfData; <span class="number">0000</span> <span class="number">1000</span></span><br><span class="line"><span class="number">0x1c</span> DWORD ImageBase;  <span class="number">0040</span> <span class="number">0000</span></span><br><span class="line"><span class="number">0x20</span> DWORD SectionAlignment; <span class="number">0000</span> <span class="number">1000</span></span><br><span class="line"><span class="number">0x24</span> DWORD FileAlignment; <span class="number">0000</span> <span class="number">1000</span></span><br><span class="line"><span class="number">0x28</span> WORD MajorOperatingSystemVersion; <span class="number">0004</span></span><br><span class="line"><span class="number">0x2a</span> WORD MinorOperatingSystemVersion; <span class="number">0000</span></span><br><span class="line"><span class="number">0x2c</span> WORD MajorImageVersion; <span class="number">0000</span></span><br><span class="line"><span class="number">0x2e</span> WORD MinorImageVersion; <span class="number">0000</span></span><br><span class="line"><span class="number">0x30</span> WORD MajorSubsystemVersion; <span class="number">0004</span></span><br><span class="line"><span class="number">0x32</span> WORD MinorSubsystemVersion; <span class="number">0000</span></span><br><span class="line"><span class="number">0x34</span> DWORD Win32VersionValue; <span class="number">0000</span> <span class="number">0000</span></span><br><span class="line"><span class="number">0x38</span> DWORD SizeOfImage;  <span class="number">0002e000</span></span><br><span class="line"><span class="number">0x3c</span> DWORD SizeOfHeaders; <span class="number">0000</span> <span class="number">1000</span></span><br><span class="line"><span class="number">0x40</span> DWORD CheckSum;  <span class="number">0000</span> <span class="number">0000</span></span><br><span class="line"><span class="number">0x44</span> WORD Subsystem;  <span class="number">0003</span></span><br><span class="line"><span class="number">0x46</span> WORD DllCharacteristics; <span class="number">0000</span></span><br><span class="line"><span class="number">0x48</span> DWORD SizeOfStackReserve; <span class="number">0010</span> <span class="number">0000</span></span><br><span class="line"><span class="number">0x4c</span> DWORD SizeOfStackCommit; <span class="number">0000</span> <span class="number">1000</span></span><br><span class="line"><span class="number">0x50</span> DWORD SizeOfHeapReserve; <span class="number">0010</span> <span class="number">0000</span></span><br><span class="line"><span class="number">0x54</span> DWORD SizeOfHeapCommit; <span class="number">0000</span> <span class="number">1000</span></span><br><span class="line"><span class="number">0x58</span> DWORD LoderFlags; <span class="number">0000</span> <span class="number">0000</span></span><br><span class="line"><span class="number">0x5c</span> DWORD NumberOfRvaAndSizes; <span class="number">0000</span> <span class="number">0010</span></span><br><span class="line"><span class="number">0x60</span> _IMAGE_DATA_DIRECTORY DataDirectory[<span class="number">16</span>];</span><br></pre></td></tr></table></figure>

</div></article><div class="copyright-wrapper"><p>原文作者:<a href="http://example.com">Hello_RS</a></p><p>原文链接:<a href="http://example.com/2023/01/04/PE%E5%A4%B4%E8%A7%A3%E6%9E%90/"></a></p><p>发表日期: 2023-01-04 21:49:06</p><p>更新日期: 2023-01-14 01:50:49</p><p>版权声明: 本文采用<a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc/4.0/">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p></div><div class="post-pager"><div class="prev"><a href="/2023/01/04/%E4%BD%8D%E6%93%8D%E4%BD%9C/" title="">上一篇 </a></div><div class="next"> <a href="/2023/01/04/%E4%BD%A0%E7%9C%9F%E7%9A%84%E6%87%82%E5%94%AF%E4%B8%80/" title="">下一篇 </a></div></div><link rel="stylesheet" href="https://cdn.staticfile.org/gitalk/1.7.2/gitalk.min.css"/><script src="https://cdn.staticfile.org/gitalk/1.7.2/gitalk.min.js"></script><div id="gitalk-container"></div><script>new Gitalk({
  clientID: '',
  clientSecret: '',
  repo: '',
  owner: 'EAN',
  admin: 'EAN',
  id: location.pathname.substr(0, 48),
  distractionFreeMode: true,
  labels: ['Gitalk'],
  title: '',
}).render('gitalk-container');</script></section></section></main><footer class="footer-page"><div><span>Powered by</span><a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a><span>| Theme</span><a target="_blank" rel="noopener" href="https://github.com/techmovie/hexo-theme-instapaper">instapaper</a></div></footer><script src="/scripts/dark.js"></script><script src="/scripts/post.js"></script></body></html>