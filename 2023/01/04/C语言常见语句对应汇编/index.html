<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible"><meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1,user-scalable=no"><meta name="renderer" content="webkit"><meta name="color-scheme" content="dark light"><meta name="author" content="John Doe"><meta name="description" content=""><meta name="keywords" content=""><title>Hexo</title><link rel="icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="//at.alicdn.com/t/font_3242539_utq6ykfq7z.css"><link rel="stylesheet" light-src="https://cdn.staticfile.org/highlight.js/11.5.0/styles/default.min.css" dark-src="https://cdn.staticfile.org/highlight.js/11.5.0/styles/tokyo-night-dark.min.css"><link rel="stylesheet" href="https://fonts.font.im/css?family=Noto+Serif" as="font"><link href="/style/index.css" rel="stylesheet"><meta name="generator" content="Hexo 5.4.2"></head><body><header class="page-header"><nav><ul class="router-list"><li class="nav-item"> <a href="/">主页</a></li><li class="nav-item"> <a href="/archives/">归档</a></li><li class="nav-item"> <a href="/atom.xml">RSS</a></li></ul><div class="mode-switch"><span class="iconfont icon-DarkTheme"></span></div></nav></header><main><section class="main-content"><section class="post-page"><div class="title-bar"><h1></h1><div class="post-info"><span>2023-01-04 21:49:06</span><span class="tags"></span></div></div><article> <div class="content"><h3 id="if语句"><a href="#if语句" class="headerlink" title="if语句"></a>if语句</h3><p>IF…ELSE…语句的反汇编判断</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">IF_BEGIN:</span><br><span class="line">	先执行各类影响标志位的指令</span><br><span class="line">	jxx ELSE_BEGIN</span><br><span class="line">	....</span><br><span class="line">IF_END:</span><br><span class="line">	jmp END</span><br><span class="line">	ELSE_BEGIN:</span><br><span class="line">	....</span><br><span class="line">	ELSE_END:</span><br><span class="line">END:</span><br></pre></td></tr></table></figure>

<p>特点分析：</p>
<p>​        1.如果不跳转，那么会执行到jmp处，jmp直接跳转到END处</p>
<p>​        2.如果跳转，则会直接跳过jmp END处的源码，直接执行后面的代码</p>
<p>​        跳转执行一部分代码，不跳转执行另外一部分代码</p>
<p>​        第一个jxx跳转的地址前面有一个jmp，可以判断是if…else…语句</p>
<p>​        如以下汇编代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">	int x=1, y=2, z=3;</span><br><span class="line">00007FF6E21534BB  mov         dword ptr [x],1  </span><br><span class="line">00007FF6E21534C2  mov         dword ptr [y],2  </span><br><span class="line">00007FF6E21534C9  mov         dword ptr [z],3  </span><br><span class="line">	if (x &gt; y)</span><br><span class="line">00007FF6E21534D0  mov         eax,dword ptr [y]  </span><br><span class="line">00007FF6E21534D3  cmp         dword ptr [x],eax  </span><br><span class="line">00007FF6E21534D6  jle         Function6+40h (07FF6E21534E0h) //判断如果小于或等于就跳转到07FF6E21534E0位置</span><br><span class="line">	&#123;</span><br><span class="line">		x = y;</span><br><span class="line">00007FF6E21534D8  mov         eax,dword ptr [y]  </span><br><span class="line">00007FF6E21534DB  mov         dword ptr [x],eax  </span><br><span class="line">	&#125;</span><br><span class="line">00007FF6E21534DE  jmp         Function6+46h (07FF6E21534E6h)//执行第一个条件成功后，就不再执行else，跳转到																	//07FF6E21534E6位置</span><br><span class="line">	else</span><br><span class="line">	&#123;</span><br><span class="line">		y = z;</span><br><span class="line">00007FF6E21534E0  mov         eax,dword ptr [z]  </span><br><span class="line">00007FF6E21534E3  mov         dword ptr [y],eax  </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">00007FF6E21534E6  lea         rsp,[rbp+128h]  </span><br><span class="line">00007FF6E21534ED  pop         rdi  </span><br><span class="line">00007FF6E21534EE  pop         rbp  </span><br><span class="line">00007FF6E21534EF  ret  </span><br></pre></td></tr></table></figure>



<h3 id="IF…ELSE-IF…ELSE-IF…多分支语句反汇编判断"><a href="#IF…ELSE-IF…ELSE-IF…多分支语句反汇编判断" class="headerlink" title="IF…ELSE IF…ELSE IF…多分支语句反汇编判断"></a>IF…ELSE IF…ELSE IF…多分支语句反汇编判断</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">IF_BEGIN:</span><br><span class="line">	影响标志位的指令</span><br><span class="line">	jxx ELSE_IF_BEGIN</span><br><span class="line">	.....</span><br><span class="line">IF_END:</span><br><span class="line">	jmp END</span><br><span class="line">ELSE_IF_BEGIN:</span><br><span class="line">	影响标志位的指令</span><br><span class="line">	jxx ELSE_BEGIN</span><br><span class="line">	.....</span><br><span class="line">ELSE_IF_END:</span><br><span class="line">	jmp END</span><br><span class="line">ELSE_BEGIN:</span><br><span class="line">	.....</span><br><span class="line">ELSE_END:</span><br><span class="line">END:</span><br><span class="line">	.....</span><br></pre></td></tr></table></figure>

<p>​        1.当每个条件跳转指令要跳转的地址前面都有jmp指令</p>
<p>​        2.这些jmp指令跳转的地址都是一样的</p>
<p>​        3.如果某个分支没有条件判断，则为else部分</p>
<p>​        观察如下汇编代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">	int x = 1, y = 2, z = 3;</span><br><span class="line">00007FF660C539EB  mov         dword ptr [x],1  //初始化局部变量</span><br><span class="line">00007FF660C539F2  mov         dword ptr [y],2  </span><br><span class="line">00007FF660C539F9  mov         dword ptr [z],3  </span><br><span class="line">	if (x &gt; y)</span><br><span class="line">00007FF660C53A00  mov         eax,dword ptr [y] </span><br><span class="line">00007FF660C53A03  cmp         dword ptr [x],eax   //判断第一个if语句</span><br><span class="line">00007FF660C53A06  jle         Function7+40h (07FF660C53A10h)//如果小于或等于就跳转07FF660C53A10地址，进行下一次																//else if判断</span><br><span class="line">	&#123;</span><br><span class="line">		x = y;</span><br><span class="line">00007FF660C53A08  mov         eax,dword ptr [y]  </span><br><span class="line">00007FF660C53A0B  mov         dword ptr [x],eax  </span><br><span class="line">	&#125;</span><br><span class="line">00007FF660C53A0E  jmp         Function7+6Dh (07FF660C53A3Dh)</span><br><span class="line">//这条语句意思为判断语句执行成功后，就不再继续往下判断，跳转到07FF660C53A3D地址，恢复堆栈，有返回值则返回返回值。</span><br><span class="line">	else if(x &gt; z)</span><br><span class="line">00007FF660C53A10  mov         eax,dword ptr [z]  </span><br><span class="line">00007FF660C53A13  cmp         dword ptr [x],eax  </span><br><span class="line">00007FF660C53A16  jle         Function7+50h (07FF660C53A20h)  </span><br><span class="line">	&#123;</span><br><span class="line">		x = z;</span><br><span class="line">00007FF660C53A18  mov         eax,dword ptr [z]  </span><br><span class="line">00007FF660C53A1B  mov         dword ptr [x],eax  </span><br><span class="line">	&#125;</span><br><span class="line">00007FF660C53A1E  jmp         Function7+6Dh (07FF660C53A3Dh)//每一个jmp地址都是一样的，代表着判断结束</span><br><span class="line">	else if (y &gt; z)</span><br><span class="line">00007FF660C53A20  mov         eax,dword ptr [z]  </span><br><span class="line">00007FF660C53A23  cmp         dword ptr [y],eax  </span><br><span class="line">00007FF660C53A26  jle         Function7+60h (07FF660C53A30h)  </span><br><span class="line">	&#123;</span><br><span class="line">		y = z;</span><br><span class="line">00007FF660C53A28  mov         eax,dword ptr [z]  </span><br><span class="line">00007FF660C53A2B  mov         dword ptr [y],eax  </span><br><span class="line">	&#125;</span><br><span class="line">00007FF660C53A2E  jmp         Function7+6Dh (07FF660C53A3Dh)  </span><br><span class="line">	else</span><br><span class="line">	&#123;</span><br><span class="line">		z = x + y;</span><br><span class="line">00007FF660C53A30  mov         eax,dword ptr [y]  // else语句是没有加判断的cmp和jle这点可以留意。</span><br><span class="line">00007FF660C53A33  mov         ecx,dword ptr [x]  </span><br><span class="line">00007FF660C53A36  add         ecx,eax  </span><br><span class="line">00007FF660C53A38  mov         eax,ecx  </span><br><span class="line">00007FF660C53A3A  mov         dword ptr [z],eax  </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">00007FF660C53A3D  lea         rsp,[rbp+128h]  </span><br><span class="line">00007FF660C53A44  pop         rdi  </span><br><span class="line">00007FF660C53A45  pop         rbp  </span><br><span class="line">00007FF660C53A46  ret </span><br></pre></td></tr></table></figure>













</div></article><div class="copyright-wrapper"><p>原文作者:<a href="http://example.com">John Doe</a></p><p>原文链接:<a href="http://example.com/2023/01/04/C%E8%AF%AD%E8%A8%80%E5%B8%B8%E8%A7%81%E8%AF%AD%E5%8F%A5%E5%AF%B9%E5%BA%94%E6%B1%87%E7%BC%96/"></a></p><p>发表日期: 2023-01-04 21:49:06</p><p>更新日期: 2023-01-14 01:35:24</p><p>版权声明: 本文采用<a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc/4.0/">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p></div><div class="post-pager"><div class="prev"></div><div class="next"> <a href="/2023/01/04/PE%E5%A4%B4%E5%AD%97%E6%AE%B5%E8%AF%B4%E6%98%8E/" title="">下一篇 </a></div></div><link rel="stylesheet" href="https://cdn.staticfile.org/gitalk/1.7.2/gitalk.min.css"/><script src="https://cdn.staticfile.org/gitalk/1.7.2/gitalk.min.js"></script><div id="gitalk-container"></div><script>new Gitalk({
  clientID: '',
  clientSecret: '',
  repo: '',
  owner: '',
  admin: '',
  id: location.pathname.substr(0, 48),
  distractionFreeMode: true,
  labels: ['Gitalk'],
  title: '',
}).render('gitalk-container');</script></section></section></main><footer class="footer-page"><div><span>Powered by</span><a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a><span>| Theme</span><a target="_blank" rel="noopener" href="https://github.com/techmovie/hexo-theme-instapaper">instapaper</a></div></footer><script src="/scripts/dark.js"></script><script src="/scripts/post.js"></script></body></html>